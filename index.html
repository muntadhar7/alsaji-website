<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AlSaji - Genuine Auto Parts</title>
  <link type="image/x-icon" rel="shortcut icon" href="/assets/ALSAJI B2B.svg">
  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body style="visibility:hidden;">
    <!-- Load static data FIRST -->
    <script src="data/static_api.js"></script>

    <!-- Then load API -->
    <script src="js/api.js"></script>

    <!-- Then load other components -->
    <script src="js/cart-manager.js"></script>
    <script src="js/vehicle-manager.js"></script>
    <script src="js/app.js"></script>
    <script src="js/main.js"></script>

  <main class="wrap">
     <div class="hero">
        <!-- Hero Image Section -->
        <div class="hero-image-container">
          <img src="../assets/hero2.jpg" alt="AlSaji - Genuine Auto Parts" class="hero-image">
        </div>

        <div class="grid fitment-grid" style="background:linear-gradient(135deg,#f0f7fd,#f7f5f8);padding:16px;border-radius:8px;">
          <!-- VIN Decoder Section -->
          <div class="vin-decoder-section" style="grid-column: 1 / -1; margin-bottom: 16px;">
            <div class="vin-input-group">
              <input type="text" id="vinInput" class="vin-input" placeholder="Enter VIN (Vehicle Identification Number)" maxlength="17">
              <button class="btn" id="decodeVin" style="margin-left: 8px;">Decode VIN</button>
            </div>
            <div id="vinResult" class="vin-result" style="display: none; margin-top: 8px; padding: 8px; background: #e8f5e9; border-radius: 4px;"></div>
            <p class="vin-help" style="font-size: 0.8rem; color: #666; margin-top: 4px;">
              Find your VIN on the driver's side dashboard or door jamb
            </p>
          </div>

          <!-- Vehicle Selection Dropdowns -->
          <select class="select" id="make">
          </select>

          <select class="select" id="model" disabled>
            <option value="">Select Model</option>
          </select>

          <select class="select" id="year" disabled>
            <option value="">Select Year</option>
          </select>

          <select class="select" id="engine" disabled>
            <option value="">Select Engine</option>
          </select>

          <select class="select" id="importType" disabled>
            <option value="">Select Import Type</option>
          </select>

          <!-- Buttons now take the space of one selector -->
          <label style="padding-top:4px">
            <div class="fitment-buttons">
              <button class="btn" id="applyFitment">Apply</button>
              <button class="btn secondary" id="clearFitment">Clear</button>
            </div>
          </label><br/>

        </div>

     </div>
    <div class="right-half-buttons" style="margin-top:12px">

     <a class="btn secondary" style="background:var(--ink1);color:white" href="/shop.html">Shop</a>
      <a class="btn secondary" style="background:var(--ink1);color:white" href="/trade.html">Agent Portal</a>
</div>
    <section>
      <div class="row between">
        <h2 style="margin-top:12px ">Popular categories</h2>
      </div>
      <div class="card">
        <div class="grid cols-10" id="popularCategories">
          <!-- Loaded by JavaScript -->
        </div>
      </div>
    </section>

    <section style="margin-top:12px">
      <div class="row between">
        <h2>Top brands</h2>
        <a class="btn ghost" href="brands.html">View all</a>
      </div>
      <div class="grid cols-6" id="topBrands">
        <!-- Loaded by JavaScript -->
      </div>
    </section>

    <section style="margin-top:12px">
      <div class="row between">
        <h2>Featured Products</h2>
      </div>
      <div class="grid cols-4" id="featuredProducts">
        <!-- Loaded by JavaScript -->
      </div>
    </section>
  </main>

  <div class="sticky-support">
    <div class="group">
      <button class="btn" style="background:#25D366">WhatsApp</button>
      <button class="btn">Live Chat</button>
    </div>
  </div>

  <script src="js/home.js"></script>

  <!-- VIN Decoder Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const vinInput = document.getElementById('vinInput');
      const decodeVinBtn = document.getElementById('decodeVin');
      const vinResult = document.getElementById('vinResult');

      // VIN validation - basic check for 17 characters
      function isValidVIN(vin) {
        return vin.length === 17 && /^[A-HJ-NPR-Z0-9]{17}$/i.test(vin);
      }

      // Update button state based on VIN input
      vinInput.addEventListener('input', function() {
        decodeVinBtn.disabled = !isValidVIN(vinInput.value.toUpperCase());
      });

      // VIN decoding functionality
      decodeVinBtn.addEventListener('click', function() {
        const vin = vinInput.value.toUpperCase();

        if (!isValidVIN(vin)) {
          showVinResult('Please enter a valid 17-character VIN', false);
          return;
        }

        // Show loading state
        decodeVinBtn.textContent = 'Decoding...';
        decodeVinBtn.disabled = true;

        // Simulate API call to decode VIN
        setTimeout(() => {
          // This is a mock implementation - replace with actual VIN decoding API
          const mockVehicleData = decodeVINMock(vin);

          if (mockVehicleData) {
            showVinResult(`Vehicle identified: ${mockVehicleData.year} ${mockVehicleData.make} ${mockVehicleData.model} ${mockVehicleData.engine || ''}`, true);

            // Auto-populate the vehicle selection dropdowns if data is available
            autoPopulateVehicleSelection(mockVehicleData);
          } else {
            showVinResult('Unable to decode VIN. Please try manual selection.', false);
          }

          // Reset button
          decodeVinBtn.textContent = 'Decode VIN';
          decodeVinBtn.disabled = false;
        }, 1500);
      });

      // Mock VIN decoding function - replace with actual API call
      function decodeVINMock(vin) {
        // This is a simplified mock - in reality you would use a VIN decoding API
        const mockData = {
          '1HGCM82633A123456': { make: 'Honda', model: 'Accord', year: '2003', engine: '2.4L' },
          '2FMDK3GC5DBA12345': { make: 'Ford', model: 'Escape', year: '2013', engine: '2.5L' },
          '5NPE24AFXFH123456': { make: 'Hyundai', model: 'Sonata', year: '2015', engine: '2.4L' },
          'JTEBU5JR6K5123456': { make: 'Toyota', model: '4Runner', year: '2019', engine: '4.0L' }
        };

        return mockData[vin] || null;
      }

      // Show VIN decoding result
      function showVinResult(message, isSuccess) {
        vinResult.textContent = message;
        vinResult.style.display = 'block';
        vinResult.style.background = isSuccess ? '#e8f5e9' : '#ffebee';
        vinResult.style.color = isSuccess ? '#2e7d32' : '#c62828';
      }

      // Auto-populate vehicle selection based on VIN data
      function autoPopulateVehicleSelection(vehicleData) {
        // This would need to be integrated with your existing vehicle selection logic
        console.log('Auto-populating vehicle selection:', vehicleData);

        // Example implementation - you'll need to adapt this to your existing code
        // document.getElementById('make').value = vehicleData.make;
        // Trigger change events to populate dependent dropdowns
        // ... rest of implementation depends on your existing vehicle-manager.js
      }
    });
  </script>
</body>
</html>