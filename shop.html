<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shop - AlSaji Auto Parts</title>
  <link type="image/x-icon" rel="shortcut icon" href="/assets/ALSAJI B2B.svg">
  <link rel="stylesheet" href="css/style.css">
</head>
<body style="visibility:hidden;">
  <script src="js/main.js"></script>
  <script src="data/static_api.js"></script>
  <script src="js/api.js"></script>
  <script src="js/shop.js"></script> <!-- Main shop logic -->
  <script src="js/mobile-filters.js"></script> <!-- Mobile filters -->
  <script src="data/html/filtering.js"></script> <!-- Mobile filters -->
  <script src="js/cart-manager.js"></script>
  <script src="js/vehicle-manager.js"></script>
  <script src="data/json/vehicle_compatibility_index.js"></script>

    <main class="wrap">
      <div class="grid shop">
        <!-- Desktop Filters (visible on desktop) -->
        <aside class="card" id="desktopFilters">
          <div style="display: flex; flex-direction: column; gap: 4px; padding: 8px 8px">
            <div class="muted" id="resultsCount">Loading products...</div>
            <h2 class="bold" style="margin: 0">Your vehicle</h2>
          </div>
          <div id="vehBox" class="card" style="background:#f9f7f9">
            <div class="muted">No vehicle selected</div>
          </div>
          <div class="row between" style="align-items: center; padding: 8px 8px">
            <h2 style="margin: 0 0 0 0;">Filters</h2>
            <button class="btn clear-filters" style="white-space: nowrap;" id="clearButton">
              Clear
            </button>
          </div>
          <div class="card">
            <div class="muted">Brand</div>
            <select class="select" id="filterBrand">
              <option value="">All Brands</option>
            </select>
          </div>
          <div class="card" style="margin-top:8px">
            <div class="muted">Category</div>
            <select class="select" id="filterCategory">
              <option value="">All Categories</option>
            </select>
          </div>
          <div class="card" style="margin-top:8px">
            <div class="muted">Price Range</div>
            <select class="select" id="filterPrice">
              <option value="">Any Price</option>
              <option value="0-50000">Under IQD 50,000</option>
              <option value="50000-100000">IQD 50,000 - 100,000</option>
              <option value="100000-200000">IQD 100,000 - 200,000</option>
              <option value="200000-9999999">Over IQD 200,000</option>
            </select>
          </div>
          <div class="card" style="margin-top:8px">
            <div class="muted">Availability</div>
            <select class="select" id="filterStock">
              <option value="">Any Stock Status</option>
              <option value="True">In Stock</option>
              <option value="False">Out of Stock</option>
            </select>
          </div>
        </aside>

        <!-- Main Content Area -->
        <section>
          <!-- Shop Header -->
<div class="shop-header row between" style="margin-bottom:8px">
  <div class="search-sort-container row" style="align-items:center; gap:16px; width: 100%;">
    <!-- Search Bar - Updated for mobile -->
    <div class="search" id="mobileSearchContainer" style="flex: 1; display: flex; align-items: center; min-width: 0;">
      <input class="search input" id="searchInput" placeholder="Search products..." style="flex: 1; min-width: 0; border: 0; outline: 0; background: transparent; padding: 8px 12px;">
      <button class="btn2" id="searchButton" style="white-space: nowrap; flex-shrink: 0; display: none;">Search</button>
    </div>

    <!-- Mobile Search Toggle Row -->
    <div class="mobile-search-toggle row" id="mobileSearchToggle" style="align-items: center; gap: 8px; width: 100%; display: none;">
      <div class="search-icon" style="flex: 1; display: flex; align-items: center; padding: 8px 12px; background: var(--w2); border-radius: 12px; cursor: pointer;">
        <span style="color: #888; ">üîç</span>
      </div>

      <!-- Filter and Sort Buttons -->
      <div class="filter-sort-buttons row" style="align-items: center; gap: 8px; flex-shrink: 16;">
        <!-- Sort Dropdown -->
        <div class="sort-container" style="position: relative; display: inline-block; min-width: 60px; flex: 1;">
          <label for="sortSelect" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #888; pointer-events: none; font-size: 14px;">Sort</label>
          <select class="select" id="sortSelect" style="padding-left: 50px; width: 100%;">
            <option>Relevance</option>
            <option>Price: Low to High</option>
            <option>Price: High to Low</option>
            <option>Newest</option>
          </select>
        </div>
        <!-- Mobile Filter Button -->
        <button class="btn2 mobile-filter-btn" id="mobileFilterBtn" style="white-space: nowrap; min-width: 80px;">
          Filters
        </button>
      </div>
    </div>
  </div>
</div>          <!-- Product Grid -->
          <div class="grid plp" id="productGrid">
            <!-- Products loaded by JavaScript -->
          </div>

          <!-- Load More Button -->
          <div id="loadMoreContainer" style="text-align: center; margin-top: 24px; display: none;">
            <button class="btn secondary" id="loadMoreBtn">
              Load More Products
            </button>
            <div id="loadMoreInfo" class="muted" style="margin-top: 8px; font-size: 14px;"></div>
          </div>
        </section>
      </div>
    </main>

    <!-- Mobile Filter Bottom Sheet -->
    <div class="mobile-filter-sheet" id="mobileFilterSheet">
      <div class="filter-overlay" id="filterOverlay"></div>
      <div class="filter-sheet-content">
        <!-- Header -->
        <div class="filter-header">
          <h3 style="margin: 0;">Filters</h3>
          <button class="filter-close" id="filterClose">
            <i style="font-size: 20px;">√ó</i>
          </button>
        </div>

        <!-- Filter Content -->
        <div class="filter-content">
          <!-- Brand Filter -->
          <div class="filter-section">
            <button class="section-title" data-section="brand">
              Brand
              <svg class="chevron" width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                <path d="M9.00019 8.49997C8.86858 8.50073 8.73812 8.4755 8.61628 8.42574C8.49444 8.37597 8.38363 8.30265 8.29019 8.20997L6.00019 5.90997L3.71019 8.20997C3.52188 8.39827 3.26649 8.50406 3.00019 8.50406C2.73388 8.50406 2.47849 8.39827 2.29019 8.20997C2.10188 8.02166 1.99609 7.76627 1.99609 7.49997C1.99609 7.23366 2.10188 6.97827 2.29019 6.78997L6.00019 3.08997L9.71019 6.78997C9.80391 6.88293 9.87831 6.99353 9.92908 7.11539C9.97985 7.23725 10.006 7.36795 10.006 7.49997C10.006 7.63198 9.97985 7.76268 9.92908 7.88454C9.87831 8.0064 9.80391 8.117 9.71019 8.20997C9.61675 8.30265 9.50593 8.37597 9.38409 8.42574C9.26225 8.4755 9.13179 8.50073 9.00019 8.49997Z"></path>
              </svg>
            </button>
            <div class="section-body" id="brandSection">
              <div class="filter-options">
                <button class="filter-pill active" data-filter="brand-all">
                  All Brands
                </button>
                <!-- Brand pills will be populated by JavaScript -->
              </div>
            </div>
          </div>
        <!-- Filter Content -->

          <!-- Category Filter -->
          <div class="filter-section">
            <button class="section-title" data-section="category">
              Category
              <svg class="chevron" width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                <path d="M9.00019 8.49997C8.86858 8.50073 8.73812 8.4755 8.61628 8.42574C8.49444 8.37597 8.38363 8.30265 8.29019 8.20997L6.00019 5.90997L3.71019 8.20997C3.52188 8.39827 3.26649 8.50406 3.00019 8.50406C2.73388 8.50406 2.47849 8.39827 2.29019 8.20997C2.10188 8.02166 1.99609 7.76627 1.99609 7.49997C1.99609 7.23366 2.10188 6.97827 2.29019 6.78997L6.00019 3.08997L9.71019 6.78997C9.80391 6.88293 9.87831 6.99353 9.92908 7.11539C9.97985 7.23725 10.006 7.36795 10.006 7.49997C10.006 7.63198 9.97985 7.76268 9.92908 7.88454C9.87831 8.0064 9.80391 8.117 9.71019 8.20997C9.61675 8.30265 9.50593 8.37597 9.38409 8.42574C9.26225 8.4755 9.13179 8.50073 9.00019 8.49997Z"></path>
              </svg>
            </button>
            <div class="section-body" id="categorySection">
              <div class="filter-options">
                <button class="filter-pill active" data-filter="category-all">
                  All Categories
                </button>
                <!-- Category pills will be populated by JavaScript -->
              </div>
            </div>
          </div>

          <!-- Price Filter -->
          <div class="filter-section">
            <button class="section-title" data-section="price">
              Price Range
              <svg class="chevron" width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                <path d="M9.00019 8.49997C8.86858 8.50073 8.73812 8.4755 8.61628 8.42574C8.49444 8.37597 8.38363 8.30265 8.29019 8.20997L6.00019 5.90997L3.71019 8.20997C3.52188 8.39827 3.26649 8.50406 3.00019 8.50406C2.73388 8.50406 2.47849 8.39827 2.29019 8.20997C2.10188 8.02166 1.99609 7.76627 1.99609 7.49997C1.99609 7.23366 2.10188 6.97827 2.29019 6.78997L6.00019 3.08997L9.71019 6.78997C9.80391 6.88293 9.87831 6.99353 9.92908 7.11539C9.97985 7.23725 10.006 7.36795 10.006 7.49997C10.006 7.63198 9.97985 7.76268 9.92908 7.88454C9.87831 8.0064 9.80391 8.117 9.71019 8.20997C9.61675 8.30265 9.50593 8.37597 9.38409 8.42574C9.26225 8.4755 9.13179 8.50073 9.00019 8.49997Z"></path>
              </svg>
            </button>
            <div class="section-body" id="priceSection">
              <div class="filter-options" id="price-filters">

              </div>
            </div>
          </div>

          <!-- Stock Filter -->
          <div class="filter-section">
            <button class="section-title" data-section="stock">
              Availability
              <svg class="chevron" width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                <path d="M9.00019 8.49997C8.86858 8.50073 8.73812 8.4755 8.61628 8.42574C8.49444 8.37597 8.38363 8.30265 8.29019 8.20997L6.00019 5.90997L3.71019 8.20997C3.52188 8.39827 3.26649 8.50406 3.00019 8.50406C2.73388 8.50406 2.47849 8.39827 2.29019 8.20997C2.10188 8.02166 1.99609 7.76627 1.99609 7.49997C1.99609 7.23366 2.10188 6.97827 2.29019 6.78997L6.00019 3.08997L9.71019 6.78997C9.80391 6.88293 9.87831 6.99353 9.92908 7.11539C9.97985 7.23725 10.006 7.36795 10.006 7.49997C10.006 7.63198 9.97985 7.76268 9.92908 7.88454C9.87831 8.0064 9.80391 8.117 9.71019 8.20997C9.61675 8.30265 9.50593 8.37597 9.38409 8.42574C9.26225 8.4755 9.13179 8.50073 9.00019 8.49997Z"></path>
              </svg>
            </button>
            <div class="section-body" id="stockSection">
              <div class="filter-options">
                <button class="filter-pill active" data-filter="stock-all">
                  Any Stock
                </button>
                <button class="filter-pill" data-filter="stock-true">
                  In Stock
                </button>
                <button class="filter-pill" data-filter="stock-false">
                  Out of Stock
                </button>
              </div>
            </div>
          </div>
        </div>


          <!-- Other filter sections remain the same -->
          <!-- ... (rest of your mobile filter code) ... -->


        <!-- Footer -->
        <div class="filter-footer">
          <button class="btn secondary" id="mobileClearFilters">
            Clear All
          </button>
          <button class="btn" id="mobileApplyFilters">
            Show Results
          </button>
        </div>
      </div>
    </div>


<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const mobileSearchContainer = document.getElementById('mobileSearchContainer');
    const mobileSearchToggle = document.getElementById('mobileSearchToggle');
    const sortSelect = document.getElementById('sortSelect');
    const mobileFilterBtn = document.getElementById('mobileFilterBtn');

    // Show mobile search toggle on mobile
    function checkMobileView() {
        if (window.innerWidth <= 768) {
            mobileSearchContainer.style.display = 'none';
            mobileSearchToggle.style.display = 'flex';
        } else {
            mobileSearchContainer.style.display = 'flex';
            mobileSearchToggle.style.display = 'none';
            searchButton.style.display = 'inline-block';
        }
    }

    // Toggle search input on mobile
    function toggleMobileSearch() {
        mobileSearchToggle.style.display = 'none';
        mobileSearchContainer.style.display = 'flex';
        searchInput.focus();
    }

    // Perform search
    function performSearch() {
        const searchTerm = searchInput.value.trim();
        console.log('Searching for:', searchTerm);
        shopState.currentPage = 1;
        shopState.filters.search = searchTerm;
        applyFilters();

        // On mobile, close search and show toggle again if search is empty
        if (window.innerWidth <= 768 && !searchTerm) {
            mobileSearchContainer.style.display = 'none';
            mobileSearchToggle.style.display = 'flex';
        }
    }

    // Event listeners
    if (mobileSearchToggle) {
        mobileSearchToggle.addEventListener('click', toggleMobileSearch);
    }

    if (searchButton) {
        searchButton.addEventListener('click', performSearch);
    }

    if (searchInput) {
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        // Close search on blur if empty (mobile)
        searchInput.addEventListener('blur', function() {
            if (window.innerWidth <= 768 && !this.value.trim()) {
                setTimeout(() => {
                    mobileSearchContainer.style.display = 'none';
                    mobileSearchToggle.style.display = 'flex';
                }, 200);
            }
        });
    }

    // Sort functionality
    if (sortSelect) {
        sortSelect.addEventListener('change', function() {
            console.log('Sort by:', this.value);
            // Add your sort logic here
        });
    }

    // Mobile filter button
    if (mobileFilterBtn) {
        mobileFilterBtn.addEventListener('click', function() {
            // Add your mobile filter sheet opening logic here
            const mobileFilterSheet = document.getElementById('mobileFilterSheet');
            if (mobileFilterSheet) {
                mobileFilterSheet.classList.add('active');
                document.body.classList.add('filter-sheet-open');
            }
        });
    }

    // Initial check
    checkMobileView();
    window.addEventListener('resize', checkMobileView);
});
</script>

<style>
/* Add these styles to your CSS */
@media (max-width: 768px) {
    .mobile-search-toggle {
        display: flex !important;
    }

    .search-sort-container {
        flex-direction: column;
        gap: 8px !important;
    }

    .mobile-search-toggle .search-icon {
        border: 1px solid var(--w1);
        transition: all 0.2s ease;
    }

    .mobile-search-toggle .search-icon:hover {
        border-color: var(--red);
        background: var(--w3);
    }

    .filter-sort-buttons {
        width: 100%;
        justify-content: space-between;
    }

    .sort-container {
        min-width: 140px !important;
    }

    .mobile-filter-btn {
        min-width: 80px !important;
    }
}

@media (min-width: 769px) {
    .mobile-search-toggle {
        display: none !important;
    }

    .search-sort-container {
        flex-direction: row !important;
    }
}
</style>
</body>
</html>