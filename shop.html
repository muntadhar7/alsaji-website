<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shop - AlSaji Auto Parts</title>
  <link type="image/x-icon" rel="shortcut icon" href="/assets/ALSAJI B2B.svg">
  <link rel="stylesheet" href="css/style.css">
  <style>
    /* Mobile responsive fixes */
    @media (max-width: 768px) {
      .shop-header {
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
      }

      .search-sort-container {
        flex-direction: column;
        gap: 8px;
        width: 100%;
      }

      .search {
        width: 100%;
        margin-right: 0;
      }

      .search input {
        width: 100%;
        color: black;
      }

      .sort-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
      }

      .sort-container .muted {
        margin-right: 0;
        white-space: nowrap;
      }

      #sortSelect {
        min-width: 150px;
      }

      /* Ensure grid doesn't overflow */
      .grid.shop {
        grid-template-columns: 1fr;
        gap: 16px;
      }

      .plp {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }

      .wrap {
        padding: 8px 16px;
      }
    }



    /* Ensure search bar styling matches your theme */
    .search {
      display: flex;
      align-items: center;
      border: 1px solid var(--w1);
      border-radius: 12px;
      padding: 4px;
      background: #fff;
      flex: 1;
    }

    .search input {
      border: 0;
      outline: 0;
      background: transparent;
      flex: 1;
      padding: 8px 12px;
      font-size: 14px;
    }

    .search input::placeholder {
      color: #6b7280;
    }
  </style>
</head>
<body style="visibility:hidden;">
<!-- Load static data FIRST -->
    <script src="js/main.js"></script>

    <script src="data/static_api.js"></script>

    <!-- Then load API -->
    <script src="js/api.js"></script>

    <!-- Then load other components -->
    <script src="js/cart-manager.js"></script>
    <script src="js/vehicle-manager.js"></script> <!-- âœ… ADD THIS -->
    <script src="data/html/filtering.js"></script>
    <script src="js/app.js"></script>


  <main class="wrap">
    <div class="grid shop">
      <aside class="card">
        <div style="display: flex; flex-direction: column; gap: 4px; padding: 8px 8px">
          <div class="muted" id="resultsCount">Loading products...</div>
          <h2 class="bold" style="margin: 0">Your vehicle</h2>
        </div>
        <div id="vehBox" class="card" style="background:#f9f7f9">
          <div class="muted">No vehicle selected</div>
        </div>
        <div class="row between" style="align-items: center; padding: 8px 8px">
          <h2 style="margin: 0 0 0 0;">Filters</h2>
          <button class="btn clear-filters" style="white-space: nowrap;">
            Clear Filters
          </button>
        </div>
        <div class="card" >
          <div class="muted">Brand</div>
          <select class="select" id="filterBrand">
            <option value="">All Brands</option>
          </select>
        </div>
        <div class="card" style="margin-top:8px">
          <div class="muted">Category</div>
          <select class="select" id="filterCategory">
            <option value="">All Categories</option>
          </select>
        </div>
        <div class="card" style="margin-top:8px">
          <div class="muted">Price Range</div>
          <select class="select" id="filterPrice">
            <option value="">Any Price</option>
            <option value="0-50000">Under IQD 50,000</option>
            <option value="50000-100000">IQD 50,000 - 100,000</option>
            <option value="100000-200000">IQD 100,000 - 200,000</option>
            <option value="200000-9999999">Over IQD 200,000</option>
          </select>
        </div>
        <div class="card" style="margin-top:8px">
          <div class="muted">Availability</div>
          <select class="select" id="filterStock">
            <option value="">Any Stock Status</option>
            <option value="True">In Stock</option>
            <option value="False">Out of Stock</option>
          </select>
        </div>
      </aside>
      <section>
        <div class="shop-header row between" style="margin-bottom:8px">
          <div class="search-sort-container row" style="align-items:center; width: 100%;">
            <!-- Search Bar -->
            <div class="search">
              <input class="search input" id="searchInput" placeholder="Search products...">
              <button class="btn2" id="searchButton" style="white-space: nowrap;">Search</button>
            </div>
            <!-- Sort Dropdown -->
<div class="sort-container" style="position: relative; display: inline-block;">
  <label for="sortSelect" style="
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #888;
    pointer-events: none;
    font-size: 14px;
  ">Sort</label>

  <select class="select" id="sortSelect" style="padding-left: 50px;">
    <option>Relevance</option>
    <option>Price: Low to High</option>
    <option>Price: High to Low</option>
    <option>Newest</option>
  </select>
</div>


          </div>
        </div>
        <div class="grid plp" id="productGrid">
          <!-- Products loaded by JavaScript -->
        </div>
        <!-- Load More Button -->
        <div id="loadMoreContainer" style="text-align: center; margin-top: 24px; display: none;">
          <button class="btn secondary" id="loadMoreBtn">
            Load More Products
          </button>
          <div id="loadMoreInfo" class="muted" style="margin-top: 8px; font-size: 14px;"></div>
        </div>
      </section>
    </div>
  </main>

  <script src="data/json/vehicle_compatibility_index.js"></script>
  <script src="js/shop.js"></script>

  <script>
    // Search functionality
    document.addEventListener('DOMContentLoaded', function() {
      const searchInput = document.getElementById('searchInput');
      const searchButton = document.getElementById('searchButton');

      // Function to perform search
      function performSearch() {
        const searchTerm = searchInput.value.trim();

        // If there's a search term, apply the search filter
        if (searchTerm) {
          // This would typically call a function from shop.js to filter products
          // For now, we'll just log the search term
          console.log('Searching for:', searchTerm);

          // In a real implementation, you would call a function from shop.js
          // For example: window.filterProductsBySearch(searchTerm);
        } else {
          // If search is empty, clear any search filters
          console.log('Clearing search');

          // In a real implementation: window.clearSearchFilter();
        }
      }

      // Search when button is clicked
      searchButton.addEventListener('click', performSearch);

      // Search when Enter key is pressed in the search input
      searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          performSearch();
        }
      });
    });
  </script>
</body>
</html>